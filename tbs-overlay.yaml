#@ load("@ytt:overlay", "overlay")

#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-admin-role"}})
---
#@overlay/remove
aggregationRule: {}
#@overlay/match missing_ok=True
rules:
  - apiGroups: [ "kpack.io" ]
    resources: [ "clusterbuilders","clusterstacks","clusterstores" ]
    verbs: [ "get","list","watch","create","patch","update","delete","deletecollection" ]

#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-user-role"}})
---
#@overlay/remove
aggregationRule: {}
#@overlay/match missing_ok=True
rules:
  - apiGroups: [ "kpack.io" ]
    resources: [ "builds" ]
    verbs: [ "patch" ]
  - apiGroups: [ "kpack.io" ]
    resources: [ "builds","builders","images" ]
    verbs: [ "get","list","watch" ]
  - apiGroups: [ "kpack.io" ]
    resources: [ "builders" ]
    verbs: [ "get","list","watch","create","patch","update","delete","deletecollection" ]
  - apiGroups: [ "kpack.io" ]
    resources: [ "clusterbuilders","clusterstacks","clusterstores" ]
    verbs: [ "get","list","watch" ]
  - apiGroups:
      - ""
    resources:
      - pods
      - pods/log
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - ""
    resources:
      - serviceaccounts
    resourceNames:
      - default
    verbs:
      - get
  - apiGroups:
      - kpack.io
    resources:
      - images
    verbs:
      - create
      - update
      - delete
      - patch
  - apiGroups:
      - kpack.io
    resources:
      - builds
    verbs:
      - update
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - create
      - update
      - delete
      - patch
      - watch

#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-cluster-resource-user-role"}})
---
#@overlay/remove
aggregationRule: {}
#@overlay/match missing_ok=True
rules:
  - apiGroups: [ "kpack.io" ]
    resources: [ "clusterbuilders","clusterstacks","clusterstores" ]
    verbs: [ "get","list","watch" ]

#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-namespaced-resource-user-role"}})
---
#@overlay/remove
aggregationRule: {}
#@overlay/match missing_ok=True
rules:
  - apiGroups: [ "kpack.io" ]
    resources: [ "builds" ]
    verbs: [ "patch" ]
  - apiGroups: [ "kpack.io" ]
    resources: [ "builds","builders","images" ]
    verbs: [ "get","list","watch" ]
  - apiGroups: [ "kpack.io" ]
    resources: [ "builders" ]
    verbs: [ "get","list","watch","create","patch","update","delete","deletecollection" ]

#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "kpack-controller-servicebindings-cluster-role"}})
---
#@overlay/remove
aggregationRule: {}
#@overlay/match missing_ok=True
rules: []



---
#@overlay/match by=overlay.subset({"kind": "Namespace", "metadata": {"name": "stacks-operator-system"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ConfigMap", "metadata": {"name": "stackify-image"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ServiceAccount", "metadata": {"name": "controller-manager"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Deployment", "metadata": {"name": "controller-manager"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "proxy-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRoleBinding", "metadata": {"name": "proxy-rolebinding"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Service", "metadata": {"name": "controller-manager-metrics-service"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "custom-stack-editor-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "custom-stack-viewer-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Role", "metadata": {"name": "leader-election-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "RoleBinding", "metadata": {"name": "leader-election-rolebinding"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "stacks-operator-manager-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRoleBinding", "metadata": {"name": "stacks-operator-manager-rolebinding"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "CustomResourceDefinition", "metadata": {"name": "customstacks.stacks.stacks-operator.tanzu.vmware.com"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Secret", "metadata": {"name": "tbs-install-pull-secret", "namespace": "stacks-operator-system"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-custom-stack-viewer-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-custom-stack-modifier-role"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "metrics-reader"}})
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"metadata": {"namespace": "cert-injection-webhook"}}), expects="2+" 
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Namespace", "metadata": {"name": "cert-injection-webhook"}}) 
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "MutatingWebhookConfiguration", "metadata": {"name": "defaults.webhook.cert-injection.tanzu.vmware.com"}}) 
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "cert-injection-webhook-cluster-role"}}) 
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "ClusterRoleBinding", "metadata": {"name": "cert-injection-webhook-cluster-role-binding"}}) 
---
#@overlay/remove
---
#@overlay/match by=overlay.subset({"kind": "Role", "metadata": {"name": "kpack-webhook-certs-admin"}})
---
#@overlay/replace
rules:
- apiGroups: [""]
  resources: [secrets]
  verbs: [get, list, watch]
- apiGroups: [""]
  resourceNames: [webhook-certs]
  resources: [secrets]
  verbs: [update]
- apiGroups: [""]
  resources: [configmaps]
  verbs: [get, list,watch]
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-user-role"}})
---
#@overlay/replace
rules:
- apiGroups:
  - kpack.io
  resources:
  - builds
  verbs:
  - patch
- apiGroups:
  - kpack.io
  resources:
  - builds
  - builders
  - images
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - kpack.io
  resources:
  - builders
  verbs:
  - get
  - list
  - watch
  - create
  - patch
  - update
  - delete
  - deletecollection
- apiGroups:
  - kpack.io
  resources:
  - clusterbuilders
  - clusterstacks
  - clusterstores
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - pods
  - pods/log
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resourceNames:
  - default
  resources:
  - serviceaccounts
  verbs:
  - get
- apiGroups:
  - kpack.io
  resources:
  - images
  verbs:
  - create
  - update
  - delete
  - patch
- apiGroups:
  - kpack.io
  resources:
  - builds
  verbs:
  - update
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-secret-syncer-role"}})
---
#@overlay/replace
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - list
  - watch
  - create
  - delete
  - update
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - kpack.io
  resources:
  - images
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
---
#@overlay/match by=overlay.subset({"kind": "ClusterRole", "metadata": {"name": "build-service-namespaced-resource-user-base-role"}})
---
#@overlay/replace
rules:
- apiGroups:
  - ""
  resources:
  - pods
  - pods/log
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resourceNames:
  - default
  resources:
  - serviceaccounts
  verbs:
  - get
- apiGroups:
  - kpack.io
  resources:
  - images
  verbs:
  - create
  - update
  - delete
  - patch
- apiGroups:
  - kpack.io
  resources:
  - builds
  verbs:
  - update
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - create
  - update
  - delete
  - patch
  - watch